import{H as q,z as ue,a as de,r as _,A as ie,L as re,d,K as L,o as i,c as me,C as p,D as R,e,w as l,f as o,j as m,i as F,m as c,k as se,s as pe}from"./index.d87ad0ed.js";function ce(f){return q({url:"/seismograph/document/list",method:"get",params:f})}function fe(f){return q({url:"/seismograph/document/"+f,method:"get"})}function ge(f){return q({url:"/seismograph/document",method:"post",data:f})}function _e(f){return q({url:"/seismograph/document",method:"put",data:f})}function he(f){return q({url:"/seismograph/document/"+f,method:"delete"})}const ve={class:"app-container"},ye={class:"dialog-footer"},be=ue({name:"Document"}),Ve=Object.assign(be,{setup(f){const k={Document:1,Report:2,Software:3}[de().name]||1,M={1:"\u64CD\u4F5C\u624B\u518C",2:"\u8D28\u68C0\u62A5\u544A",3:"\u66F4\u65B0\u8BBE\u5907"}[k],{proxy:g}=pe();g.useDict("document_type");const T=_([]),b=_(!1),D=_(!0),C=_(!0),U=_([]),K=_(!0),P=_(!0),x=_(0),N=_(""),Q=ie({form:{},queryParams:{pageNum:1,pageSize:10,type:k,equipmentSeries:null,equipmentIdentity:null},rules:{type:[{required:!0,message:"\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],documentName:[{required:!0,message:"\u6587\u6863\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],documentUri:[{required:!0,message:"\u6587\u6863URL\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:r,form:a,rules:j}=re(Q);function w(){D.value=!0,ce(r.value).then(u=>{T.value=u.rows,x.value=u.total,D.value=!1})}function A(){b.value=!1,$()}function $(){a.value={documentMgtId:null,type:k.toString(),equipmentSeries:null,equipmentIdentity:null,documentName:null,documentUri:null,createTime:null,updateTime:null},g.resetForm("documentRef")}function S(){r.value.pageNum=1,w()}function H(){g.resetForm("queryRef"),S()}function O(u){U.value=u.map(t=>t.documentMgtId),K.value=u.length!=1,P.value=!u.length}function G(){$(),b.value=!0,N.value=`\u6DFB\u52A0${M}`}function z(u){$();const t=u.documentMgtId||U.value;fe(t).then(h=>{a.value=h.data,b.value=!0,N.value=`\u4FEE\u6539${M}`})}function J(){g.$refs.documentRef.validate(u=>{u&&(a.value.documentMgtId!=null?_e(a.value).then(t=>{g.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),b.value=!1,w()}):ge(a.value).then(t=>{g.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),b.value=!1,w()}))})}function B(u){const t=u.documentMgtId||U.value;g.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u6587\u6863\u7BA1\u7406\u7F16\u53F7\u4E3A"'+t+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return he(t)}).then(()=>{w(),g.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function W(){g.download("seismograph/document/export",{...r.value},`document_${new Date().getTime()}.xlsx`)}return w(),(u,t)=>{const h=d("el-input"),v=d("el-form-item"),s=d("el-button"),E=d("el-form"),I=d("el-col"),X=d("right-toolbar"),Y=d("el-row"),y=d("el-table-column"),Z=d("el-link"),ee=d("el-table"),te=d("pagination"),le=d("file-upload"),ne=d("el-dialog"),V=L("hasPermi"),oe=L("loading");return i(),me("div",ve,[p(e(E,{model:o(r),ref:"queryRef",inline:!0,"label-width":"68px"},{default:l(()=>[o(k)==2?(i(),m(v,{key:0,label:"\u8BBE\u5907ID",prop:"equipmentIdentity"},{default:l(()=>[e(h,{modelValue:o(r).equipmentIdentity,"onUpdate:modelValue":t[0]||(t[0]=n=>o(r).equipmentIdentity=n),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907ID",clearable:"",onKeyup:F(S,["enter"])},null,8,["modelValue","onKeyup"])]),_:1})):(i(),m(v,{key:1,label:"\u8BBE\u5907\u7CFB\u5217",prop:"equipmentSeries"},{default:l(()=>[e(h,{modelValue:o(r).equipmentSeries,"onUpdate:modelValue":t[1]||(t[1]=n=>o(r).equipmentSeries=n),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907\u7CFB\u5217",clearable:"",onKeyup:F(S,["enter"])},null,8,["modelValue","onKeyup"])]),_:1})),e(v,null,{default:l(()=>[e(s,{type:"primary",icon:"Search",onClick:S},{default:l(()=>[c("\u641C\u7D22")]),_:1}),e(s,{icon:"Refresh",onClick:H},{default:l(()=>[c("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[R,C.value]]),e(Y,{gutter:10,class:"mb8"},{default:l(()=>[e(I,{span:1.5},{default:l(()=>[p((i(),m(s,{type:"primary",plain:"",icon:"Plus",onClick:G},{default:l(()=>[c("\u65B0\u589E ")]),_:1})),[[V,["seismograph:document:add"]]])]),_:1},8,["span"]),e(I,{span:1.5},{default:l(()=>[p((i(),m(s,{type:"success",plain:"",icon:"Edit",disabled:K.value,onClick:z},{default:l(()=>[c("\u4FEE\u6539 ")]),_:1},8,["disabled"])),[[V,["seismograph:document:edit"]]])]),_:1},8,["span"]),e(I,{span:1.5},{default:l(()=>[p((i(),m(s,{type:"danger",plain:"",icon:"Delete",disabled:P.value,onClick:B},{default:l(()=>[c("\u5220\u9664 ")]),_:1},8,["disabled"])),[[V,["seismograph:document:remove"]]])]),_:1},8,["span"]),e(I,{span:1.5},{default:l(()=>[p((i(),m(s,{type:"warning",plain:"",icon:"Download",onClick:W},{default:l(()=>[c("\u5BFC\u51FA ")]),_:1})),[[V,["seismograph:document:export"]]])]),_:1},8,["span"]),e(X,{showSearch:C.value,"onUpdate:showSearch":t[2]||(t[2]=n=>C.value=n),onQueryTable:w},null,8,["showSearch"])]),_:1}),p((i(),m(ee,{data:T.value,onSelectionChange:O},{default:l(()=>[e(y,{type:"selection",width:"55",align:"center"}),e(y,{label:"ID",align:"center",prop:"documentMgtId",width:"80"}),o(k)==2?(i(),m(y,{key:0,label:"\u8BBE\u5907ID",align:"center",prop:"equipmentIdentity"})):(i(),m(y,{key:1,label:"\u8BBE\u5907\u7CFB\u5217",align:"center",prop:"equipmentSeries"})),e(y,{label:"\u6587\u6863",align:"center",prop:"documentName"}),e(y,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",width:"180"}),e(y,{label:"\u4FEE\u6539\u65F6\u95F4",align:"center",prop:"updateTime",width:"180"}),e(y,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width",width:"200"},{default:l(n=>[p((i(),m(s,{link:"",type:"primary",icon:"Edit",onClick:ae=>z(n.row)},{default:l(()=>[c("\u4FEE\u6539 ")]),_:2},1032,["onClick"])),[[V,["seismograph:document:edit"]]]),p((i(),m(s,{link:"",type:"primary",icon:"Delete",onClick:ae=>B(n.row)},{default:l(()=>[c("\u5220\u9664 ")]),_:2},1032,["onClick"])),[[V,["seismograph:document:remove"]]]),p((i(),m(Z,{href:`${n.row.documentUri}`,underline:!1,target:"_blank"},{default:l(()=>[e(s,{link:"",type:"primary",icon:"Download"},{default:l(()=>[c("\u4E0B\u8F7D")]),_:1})]),_:2},1032,["href"])),[[V,["seismograph:document:download"]]])]),_:1})]),_:1},8,["data"])),[[oe,D.value]]),p(e(te,{total:x.value,page:o(r).pageNum,"onUpdate:page":t[3]||(t[3]=n=>o(r).pageNum=n),limit:o(r).pageSize,"onUpdate:limit":t[4]||(t[4]=n=>o(r).pageSize=n),onPagination:w},null,8,["total","page","limit"]),[[R,x.value>0]]),e(ne,{title:N.value,modelValue:b.value,"onUpdate:modelValue":t[10]||(t[10]=n=>b.value=n),width:"500px","append-to-body":""},{footer:l(()=>[se("div",ye,[e(s,{type:"primary",onClick:J},{default:l(()=>[c("\u786E \u5B9A")]),_:1}),e(s,{onClick:A},{default:l(()=>[c("\u53D6 \u6D88")]),_:1})])]),default:l(()=>[e(E,{ref:"documentRef",model:o(a),rules:o(j),"label-width":"80px"},{default:l(()=>[p(e(v,{label:"\u7C7B\u578B",prop:"type"},{default:l(()=>[e(h,{modelValue:o(a).type,"onUpdate:modelValue":t[5]||(t[5]=n=>o(a).type=n),placeholder:"\u8BF7\u8F93\u5165\u7C7B\u578B"},null,8,["modelValue"])]),_:1},512),[[R,!1]]),e(v,{label:"\u7CFB\u5217\u540D\u79F0",prop:"equipmentSeries"},{default:l(()=>[e(h,{modelValue:o(a).equipmentSeries,"onUpdate:modelValue":t[6]||(t[6]=n=>o(a).equipmentSeries=n),placeholder:"\u8BF7\u8F93\u5165\u7CFB\u5217\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(v,{label:"\u8BBE\u5907ID",prop:"equipmentIdentity"},{default:l(()=>[e(h,{modelValue:o(a).equipmentIdentity,"onUpdate:modelValue":t[7]||(t[7]=n=>o(a).equipmentIdentity=n),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907ID"},null,8,["modelValue"])]),_:1}),e(v,{label:"\u6587\u6863\u540D\u79F0",prop:"documentName"},{default:l(()=>[e(h,{modelValue:o(a).documentName,"onUpdate:modelValue":t[8]||(t[8]=n=>o(a).documentName=n),placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(v,{label:"\u6587\u6863",prop:"documentUri"},{default:l(()=>[e(le,{modelValue:o(a).documentUri,"onUpdate:modelValue":t[9]||(t[9]=n=>o(a).documentUri=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ve as default};
